{% load static %}
{% load tailwind_tags %}
{% load account %}

<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Chat Room</title>
  {% tailwind_css %}
  <style>
    body {
      background: linear-gradient(135deg, #f8fafc 0%, #fbc2eb 100%);
      min-height: 100vh;
      margin: 0;
      padding: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      font-family: 'Inter', sans-serif;
    }
    .chat-card {
      background: rgba(255, 255, 255, 0.9);
      border-radius: 1rem;
      box-shadow: 0 8px 32px rgba(31, 38, 135, 0.15);
      width: 100%;
      max-width: 600px;
      display: flex;
      flex-direction: column;
      overflow: hidden;
    }
    .messages {
      flex: 1;
      overflow-y: auto;
      padding: 1rem;
      display: flex;
      flex-direction: column;
      gap: 0.75rem;
      background: rgba(250, 250, 250, 0.8);
    }
    .bubble {
      max-width: 75%;
      padding: 0.6rem 1rem;
      border-radius: 1rem;
      font-size: 0.95rem;
      line-height: 1.4;
      word-wrap: break-word;
      box-shadow: 0 2px 6px rgba(0,0,0,0.1);
    }
    .bubble.me {
      align-self: flex-end;
      background: #f472b6; /* pink */
      color: white;
      border-bottom-right-radius: 0.3rem;
    }
    .bubble.other {
      align-self: flex-start;
      background: #e5e7eb; /* light gray */
      color: #111827;
      border-bottom-left-radius: 0.3rem;
    }
    .chat-footer {
      display: flex;
      gap: 0.5rem;
      padding: 0.75rem 1rem;
      background: white;
      border-top: 1px solid #fbc2eb;
    }
  </style>
</head>
<body>

  <main class="chat-card">
    <!-- Header -->
    <header class="p-4 border-b border-pink-200 bg-white/80 text-center">
      <h1 class="text-xl font-bold text-pink-600">Chat in {{room_name}}</h1>
      <p class="text-sm text-gray-600">Hi, <span class="font-semibold">{% user_display user %}</span></p>
    </header>

    <!-- Messages Section -->
    <div id="msg_div" class="messages">
      <!-- Example Messages -->
      <div class="bubble other">Hey! Welcome to the {{room_name}} ðŸŽ‰</div>
      <div class="bubble me">Hi there ðŸ˜Ž</div>
    </div>

    <!-- Input Form -->
    <form action="" id="form" class="chat-footer">
      <input 
        type="text" 
        name="message" 
        placeholder="Type your message..." 
        autocomplete="off"
        class="flex-1 px-4 py-2 rounded-full border border-gray-300 focus:ring-2 focus:ring-pink-400 focus:border-pink-400 bg-gray-50 text-gray-900 transition duration-150"
      />
      <button 
        type="submit"
        class="px-5 py-2 rounded-full bg-pink-600 text-white font-medium hover:bg-pink-700 transition duration-150 shadow">
        âž¤
      </button>
    </form>
  </main>
  <!--to figure out eiter the message is sent by the user itself or annyi=one else in the room-->
  <span id="current-username" hidden>{{ user.username }}</span>
  <span id="room-name" hidden>{{ room_name|json_script:"room-name" }}</span>
  <script type="application/json" id="room-name"></script>
  <script src='{% static "chat/chat_script.js" %}'></script>
</body>
</html>
